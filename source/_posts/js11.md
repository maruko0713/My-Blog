---
title: Javascriptç³»ç»Ÿå¤ä¹ ï¼šJavascriptä¸­çš„é¢å‘å¯¹è±¡(OOP)ä¹‹ç»§æ‰¿å’ŒåŸå‹
date: 2016-08-29
tags: ["javascript"]
---
## å‰è¨€:
Javascriptä¸­çš„OOP,å…¶å®ä¸æ­¢Javascriptä¸­æœ‰OOP,é¢å‘å¯¹è±¡æ€æƒ³åœ¨å¾ˆå¤šè¯­è¨€ä¸­éƒ½æœ‰ä½“ç°ã€‚   
å…ˆçœ‹ä¸€ä¸‹é¢å‘å¯¹è±¡çš„å®šä¹‰:    
> é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼Œæ˜¯ä¸€ç§ç¨‹åºè®¾è®¡èŒƒå‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§ç¨‹åºå¼€å‘çš„æ–¹æ³•ã€‚å¯¹è±¡æŒ‡çš„æ˜¯ç±»çš„å®ä¾‹ã€‚å®ƒå°†å¯¹è±¡ä½œä¸ºç¨‹åºçš„åŸºæœ¬å•å…ƒï¼Œå°†ç¨‹åºå’Œæ•°æ®å°è£…å…¶ä¸­ï¼Œä»¥æé«˜è½¯ä»¶çš„é‡ç”¨æ€§ï¼Œçµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚    
> 

é¢å‘å¯¹è±¡çš„å‡ ä¸ªé‡ç‚¹æ€æƒ³ï¼š    
- ç»§æ‰¿
- å°è£…
- å¤šæ€
- æŠ½è±¡

è¿™äº›æ€æƒ³åœ¨Javascriptä¸­éƒ½å¯ä»¥ä½“ç°ã€‚   
   
## ç»§æ‰¿
### åŸºäºåŸå‹çš„ç»§æ‰¿
æ ¹æ®ä¸€ä¸ªæ„é€ å‡½æ•°ç”Ÿæˆçš„å¯¹è±¡ä¼šç»§æ‰¿è¿™ä¸ªæ„é€ å‡½æ•°åŸå‹é“¾ä¸Šçš„å†…å®¹ã€‚
ğŸŒ°ï¼š    
   
```js
function Foo() {
  this.y = 2;
}
typeof Foo.prototype; //"object"
Foo.prototype.x = 1;
var obj3 = new Foo();

obj3.y; //2
obj3.x; //1
```

<!-- more -->
é‚£ä¹ˆæˆ‘ä»¬æ­¤æ—¶æ¥å…³æ³¨ä¸€ä¸‹Foo.prototypeè¿™ä¸ªä¸œè¥¿ã€‚   
å½“æˆ‘ä»¬å†™å‡ºä¸€ä¸ªç©ºå‡½æ•°çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°è‡ªåŠ¨æ‹¥æœ‰ä¸€ä¸ªprototypeå±æ€§ï¼Œå¹¶ä¸”é»˜è®¤æ‹¥æœ‰ä¸¤ä¸ªå±æ€§:   
- constructor
- \_\_proto\_\_
   
### å¦‚ä½•ä½¿ä¸€ä¸ªclassç»§æ‰¿å¦ä¸€ä¸ªclass?  
ğŸŒ°ï¼š   
   
```js
function Person(name, age) {
  this.name = name;
  this.age = age;
}

Person.prototype.hi = function() {
  console.log("Hi my name is" + this.name + "I'm" + this.age + "years old now");
}

Person.prototype.LES_NUM = 2;
Person.prototype.ARMS_NUM = 2;
Person.prototype.walk = function() {
  console.log(this.name + "is walking...");
}

function Student(name, age, className) {
  Person.call(this, name, age);
  this.className = className;
}

Student.prototype = Object.create(Person.prototype);
Student.prototype.constructor = Student;

Student.prototype.hi = function() {
  console.log("Hi my name is " + this.name + "years old now, and from" + this.className + ".");
}

Student.prototype.learn = function(subject) {
  console.log(this.name + "is learning" + subject + "at" + this.className + ".");
}

//test
var wanzi = new Student("wanzi",20,"class3,grade2");
wanzi.hi(); // Hi, my name is Wanzi, I'm 20 years old now,and from class 3, grade2
wanzi.LEGS_NUM; //2
wanzi.walk(); // wanzi is walking
wanzi.learn("math"); // wanzi is learning math at class3, grade2
```

å””ã€‚ã€‚ã€‚ã€‚æ„Ÿè§‰å¥½åƒæ²¡æœ‰ä»€ä¹ˆå¯ä»¥ç”¨è¯­è¨€æè¿°çš„ï¼Œæˆ‘è®¤ä¸ºæœ‰å¿…è¦è®°ä½è¿™ä¸ªå¥—è·¯ã€‚   
   
### åŸå‹é“¾
åŸå‹å’ŒåŸå‹ä¹‹é—´ç»„æˆçš„é“¾æ¡å°±æ˜¯åŸå‹é“¾ï¼ŒåŸå‹é“¾æ˜¯ç”±\_\_proto\_\_è¿™ä¸ªå±æ€§å†³å®šçš„ã€‚    
æˆ‘ä»¬åœ¨ç ”ç©¶åŸå‹é“¾çš„æ—¶å€™ï¼Œæ˜¯ä¸æ–­åœ°æŸ¥æ‰¾æ¯ä¸ªprototypeä¸­çš„\_\_proto\_\_æ¥æ‰¾å‡ºå®ƒçš„ä¸Šä¸€ä¸ªåŸå‹ï½ï½    
å½“æˆ‘ä»¬ä½¿ç”¨instanecofè¿™ä¸ªè¿ç®—ç¬¦æ¥åˆ¤æ–­ä¸€ä¸ªå®ä¾‹å±äºå“ªä¸ªç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”¨çš„ä¹Ÿæ˜¯åŸå‹é“¾ï¼Œå³\_\_proto\_\_ç»„æˆçš„é‚£ä¸ªé“¾æ¡ã€‚   
æ¥¼ä¸Šé‚£æ®µä»£ç ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨hiçš„æ—¶å€™ï¼Œå‘ç”Ÿäº†å•¥ï¼Ÿ   
å®ƒé¦–å…ˆçœ‹è¿™ä¸ªå¯¹è±¡ä¸Šæœ‰æ²¡æœ‰hiæ–¹æ³•ï¼Œæ²¡æœ‰ï¼Œäºæ˜¯å®ƒæŸ¥æ‰¾\_\_proto\_\_,æ ¹æ®è¿™ä¸ªå±æ€§æ‰¾åˆ°äº†æ„é€ å‡½æ•°çš„åŸå‹ï¼Œå‘ç°åŸå‹ä¸Šæœ‰ï¼Œäºæ˜¯è°ƒç”¨è¿™ä¸ªã€‚   
ç±»ä¼¼åœ°ï¼ŒARMS\_NUM,LEGS\_NUM,ä¹Ÿéƒ½æ˜¯è¿™ç§å¥—è·¯ã€‚    
   
### æ‰¾åˆ°åŸå‹çš„æ–¹æ³•
å¯¹äºä¸€ä¸ªå¯¹è±¡æ¥è¯´ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹æ–¹æ³•æ‰¾åˆ°å®ƒçš„åŸå‹ï¼š   
   
#### ç”¨\_\_proto\_\_å±æ€§æ¥æŸ¥æ‰¾
```js
var obj = {x:1};
obj.x; //1
obj.__proto__; // Object{}
```
   
#### ç”¨Object.getPrototypeOfæ¥æŸ¥æ‰¾
```js
var obj = {x:1};
obj.x; //1
Object.getPrototypeOf(obj); // {} ï¼ˆæŒ‡å‘çš„è¿˜æ˜¯Objectçš„åŸå‹å¯¹è±¡ï¼‰
```

### å¹¶ä¸æ˜¯æ‰€æœ‰çš„å¯¹è±¡åŸå‹é“¾ä¸Šéƒ½æœ‰Object.prototype
ğŸŒ°ï¼š

```js
var obj2 = Object.create(null);
obj2.__proto__; //undefined
```
è¿™ä¸ªå¯¹è±¡æ˜¯æ²¡æœ‰åŸå‹çš„ã€‚    
  
### å¹¶ä¸æ˜¯æ‰€æœ‰çš„å‡½æ•°éƒ½æœ‰prototypeå±æ€§
ğŸŒ°ï¼š   
   
```js
function abc() {

}
var binded = abc.bind(null);
binded.prototype; // undefined
```

## prototypeå±æ€§æ›´è¿›ä¸€æ­¥
æ³¨æ„ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹prototypeçš„å±æ€§å€¼çš„æ—¶å€™ï¼Œä¼šå½±å“å·²ç»åˆ›å»ºçš„å®ä¾‹ã€‚   
å¦‚æœç›´æ¥æ”¹åŠ¨prototypeè¿™ä¸ªä¸œè¥¿ï¼Œä¹Ÿå°±æ˜¯é‡æ–°ç»™prototypeèµ‹å€¼ï¼Œæ˜¯ä¸ä¼šå½±å“å·²ç»åˆ›å»ºçš„å®ä¾‹çš„ã€‚   
ğŸŒ°ï¼ˆæ¥ç¬¬ä¸€æ®µé•¿ä»£ç ï¼‰ï¼š   
   
```js
Student.prototype.x = 101;
wanzi.x; //101

Student.prototype = {y:2};
wanzi.y; //undefined
wanzi.x; //101
```

Object.prototypeæ˜¯åŸå‹é“¾çš„æœ«ç«¯ï¼Œå®ƒçš„_\_\_proto\_\_æŒ‡å‘nullã€‚   

## åŸºäºåŸå‹é“¾çš„instanceofè¿ç®—ç¬¦
instanceofå·¦è¾¹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå³è¾¹æ˜¯ä¸€ä¸ªæ„é€ å™¨ï¼Œå®ƒä¼šåˆ¤æ–­å³è¾¹çš„prototypeå±æ€§æ˜¯å¦å‡ºç°åœ¨å·¦è¾¹çš„åŸå‹é“¾ä¸Šã€‚    
ğŸŒ°ï¼ˆæ¥åœ¨ç¬¬ä¸€å¤§æ®µä»£ç åé¢ï¼‰ï¼š
   
```js
wanzi instanceof Person; //true
wanzi instanecof Student; //true
wanzi instanceof Object; //true
```
è¿™äº›true,true,trueå°±æ˜¯å› ä¸ºå·¦è¾¹çš„åŸå‹é“¾ä¸Šæœ‰å³è¾¹çš„prototypeã€‚    
    
## å®ç°ç»§æ‰¿çš„æ–¹å¼
ç”¨ä»£ç æ¥è¯´æ˜:    
   
```js
function Person() {

} 
function Student() {

} 
Student.prototype = Person.prototype; //1
Student.prototype ï¼ new Person(); //2
Student.prototype = Object.create(Person.prototype); //3
Student.prototype.constructor = Person;
```

ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä¸è¡Œçš„ï¼Œæ”¹å˜äº†Student.prototypeçš„åŒæ—¶ä¹Ÿä¼šæ”¹å˜Person,è¿™æ ·æ˜¯ä¸è¡Œçš„ã€‚    
æ–¹æ³•2å­˜åœ¨ä¸€ä¸ªé—®é¢˜æ˜¯ä½ å¦‚æœç»™Personä¼ äº†å‚æ•°å°±ä¼šå¾ˆå¥‡æ€ªã€‚   
æ–¹æ³•3ç›¸å¯¹æ¥è¯´æ˜¯æ¯”è¾ƒåˆé€‚çš„ã€‚    
ä¸è¿‡æ³¨æ„ï¼ŒObject.createæ–¹æ³•æ˜¯ES5ä¹‹åæ‰æœ‰ï¼Œå¯¹äºES5ä¹‹å‰ï¼Œæˆ‘å†™è¿‡å¦ä¸€ç¯‡æ–‡ç« æ¥æ¨¡æ‹Ÿä¸€ä¸ªç±»ä¼¼çš„æ–¹æ³•å®ç°ç»§æ‰¿çš„ï¼Œåœ¨è¿™é‡Œ:[å®ç°ä¸€ä¸ªæ­£ç¡®çš„é•¿é•¿çš„åŸå‹é“¾](https://maruko0713.github.io/2016/09/04/prototype/)ã€‚    
   
## æ€»ç»“
è¿™ç¯‡æ–‡ç« å†™å®Œï¼Œæ„Ÿè§‰è‡ªå·±çš„è„‘è¢‹æ¸…é†’äº†å¾ˆå¤šã€‚   
åŸå‹é“¾ç»§æ‰¿è¿™ä¸€å—ï¼Œæˆ‘æ˜¯å…ˆçœ‹äº†å»–é›ªå³°è€å¸ˆçš„æ•™ç¨‹ï¼Œç„¶åçœ‹çš„ä¹¦ï¼Œè§‰å¾—å®ƒä»¬ä¹‹é—´é…åˆèµ·æ¥ï¼Œå¯¹æˆ‘çš„ç†è§£å¾ˆæœ‰å¸®åŠ©ã€‚    
æ€»ä¹‹ï¼Œå¾ˆå¼€å¿ƒï¼Œå˜¿å˜¿å˜¿ï½ï½    




